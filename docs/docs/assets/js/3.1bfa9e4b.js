(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{168:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=s.__importDefault(i(180));e.Attribute=class{constructor(t,e){this.key=t,this.value=e}};class n{constructor(t,e){this.box=t,this.attrs=e}static of(t){const e=t.reduce((t,e)=>(t[e.key]=e.value,t),{}),{id:i,x:a,y:h,width:c,height:u,margin:l,padding:d}=e,_=s.__rest(e,["id","x","y","width","height","margin","padding"]),g={id:i,x:o(a),y:o(h),width:o(c),height:o(u),margin:r.default.parse(l),padding:r.default.parse(d)};return Object.keys(g).forEach(t=>{void 0===g[t]&&delete g[t]}),new n(g,_)}static fromBox(t){return new n(t,{})}merge(t){return new n(Object.assign({},this.box,t.box),Object.assign({},this.attrs,t.attrs))}}function o(t){return t?Number(t):void 0}n.empty=n.of([]),e.Attributes=n,e.num=o;e.ElementAttribute=class{constructor(t,e){this.elementName=t,this.attributes=e}},e.toDict=function(t){return t.reduce((t,e)=>(t[e.elementName]=n.of(e.attributes),t),{})}},176:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Svg=class{static of(t,e={}){const i=document.createElementNS("http://www.w3.org/2000/svg",t);return Object.keys(e).forEach(t=>i.setAttribute(t,e[t].toString())),i}}},180:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e,i,s){this.top=t,this.right=e,this.bottom=i,this.left=s}static parse(t){if(t){const e=t.split(" ").map(t=>Number(t));return 4===e.length?s.gap4(e[0],e[1],e[2],e[3]):2===e.length?s.gap2(e[0],e[1]):1===e.length?s.gap1(e[0]):void 0}}static gap1(t){return new s(t,t,t,t)}static gap2(t,e){return new s(t,e,t,e)}static gap4(t,e,i,r){return new s(t,e,i,r)}toString(){return`${this.top} ${this.right} ${this.bottom} ${this.left}`}}s.zero=s.gap1(0),e.default=s},192:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159).__importDefault(i(180));class r{constructor(t,e,i,s,r,n){this.x=t,this.y=e,this.width=i,this.height=s,this.margin=r,this.padding=n}static of(t){const{x:e,y:i,width:n,height:o,margin:a,padding:h}=Object.assign({x:0,y:0,width:0,height:0,margin:s.default.zero,padding:s.default.zero},t);return new r(e,i,n,o,a,h)}get grossArea(){const{x:t,y:e,width:i,height:s}=this,{left:r,right:n,top:o,bottom:a}=this.margin;return{x:t-r,y:e-o,width:r+i+n,height:o+s+a}}get area(){return this}get contentArea(){const{x:t,y:e,width:i,height:s,padding:r}=this;return{x:t+r.left,y:e+r.top,width:i-(r.left+r.right),height:s-(r.top+r.bottom)}}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}inflate(t){const{x:e,y:i,width:s,height:n}=t,{left:o,right:a,top:h,bottom:c}=this.padding;return new r(e-o,i-h,o+s+a,h+n+c,this.margin,this.padding)}calcGrossArea(t,e){const{x:i,y:s}=t,{width:r,height:n}=e,{left:o,right:a,top:h,bottom:c}=this.margin,u=r?{width:r+(o+a)}:{},l=n?{height:n+(h+c)}:{};return Object.assign({x:i-o,y:s-h},u,l)}calcArea(t,e={}){const{x:i,y:s}=t,{width:r,height:n}=e,{left:o,right:a,top:h,bottom:c}=this.margin,u=r?{width:r-(o+a)}:{},l=n?{height:n-(h+c)}:{};return Object.assign({x:i+o,y:s+h},u,l)}calcContentArea(t,e={}){const{x:i,y:s,width:r,height:n}=this.calcArea(t,e),{left:o,right:a,top:h,bottom:c}=this.padding,u=r?{width:r-(o+a)}:{},l=n?{height:n-(h+c)}:{};return Object.assign({x:i+o,y:s+h},u,l)}update(t){return r.of(Object.assign({},this,t))}}r.zero=r.of({}),e.Box=r},202:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(168);e.visible=function(t){return t.updateAttributes(new s.Attributes({},{visibility:"visible"}))},e.hide=function(t){return t.updateAttributes(new s.Attributes({},{visibility:"hidden"}))}},204:function(t,e,i){"use strict";i.r(e);var s=i(205),r=i.n(s);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);e.default=r.a},205:function(t,e,i){"use strict";var s;Object.defineProperty(e,"__esModule",{value:!0});const r=i(159),n=i(264),o=r.__importDefault(i(266)),a=i(353);let h=s=class extends n.Vue{constructor(){super(...arguments),this.version=-1,this.furumaiData={}}appUrl(t){return`/furumai/#/apps/${t}`}mounted(){if(this.url){const t=this.url.split("/");if(t[0]!==s.codec.formatVersion)throw new Error(`unsupported data format version: ${t[0]}`);{const e=s.codec.decode(t[1]),{version:i}=e,n=r.__rest(e,["version"]);if(!(i&&i>0))throw new Error("app version is not specified");this.version=i,this.furumaiData=n}}}};h.codec=new a.DataEncoderDecoderV1,r.__decorate([n.Prop({default:"no name"})],h.prototype,"filename",void 0),r.__decorate([n.Prop()],h.prototype,"url",void 0),r.__decorate([n.Prop({default:"true"})],h.prototype,"viewCode",void 0),h=s=r.__decorate([n.Component({components:{FurumaiApp1:o.default}})],h),e.default=h},206:function(t,e,i){"use strict";i.r(e);var s=i(207),r=i.n(s);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);e.default=r.a},207:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=i(264),n=i(267);let o=class extends r.Vue{constructor(){super(...arguments),this.errors=""}onRouteChanged(t,e){this.draw(this.furumaiData.code)}pre(t){return t.replace(/</g,"&lt;")}mounted(){const t=this.$refs.editor;t&&t.focus(),this.draw(this.furumaiData.code)}furumai(){this.changeUrl(this.furumaiData)}download(){const t=this.$refs.moments.getElementsByClassName("card");for(let e=0;e<t.length;e++){const i=t.item(e);if(i){const t='<?xml version="1.0" encoding="UTF-8"?>'+i.innerHTML,s=window.URL.createObjectURL(new Blob([t],{type:"image/svg+xml"})),r=document.createElement("a");r.href=s,r.download=`furumai-${e}.svg`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}}}toSvgOrError(t){try{return n.toSvg(t,this.furumaiData.rough||!1)}catch(t){return t}}draw(t){this.errors="";Object.assign({},this.furumaiData.animation);const e=this.$refs.moments;if(!e)throw new Error("error! not found error div dom");{e.innerHTML="";let i=this.toSvgOrError(t);if(i instanceof Error){const t=i.stack||"";this.errors=t}else{if(!this.furumaiData.displayFirstSvg){const[t,...e]=i;i=e.length>0?e:i}i.forEach(t=>{const i=document.createElement("div");i.classList.add("card"),i.appendChild(t),e.appendChild(i)})}}}};s.__decorate([r.Prop({default:{}})],o.prototype,"furumaiData",void 0),s.__decorate([r.Prop()],o.prototype,"changeUrl",void 0),s.__decorate([r.Prop({default:!0})],o.prototype,"editorMode",void 0),s.__decorate([r.Prop({default:!0})],o.prototype,"viewCode",void 0),s.__decorate([r.Watch("$route")],o.prototype,"onRouteChanged",null),o=s.__decorate([r.Component],o),e.default=o},226:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(176);e.marginRect=function(t){const{x:e,y:i,width:r,height:n,margin:o}=t;return s.Svg.of("rect",{fill:"none",stroke:"none",visibility:"hidden",x:e-o.left,y:i-o.top,width:o.left+r+o.right,height:o.top+n+o.bottom})}},227:function(t,e,i){},228:function(t,e,i){},257:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=i(176),n=i(258),o=i(340),a=i(261),h=i(192),c=i(168);e.Story=class{constructor(t){this.ss=t}get mode(){const t=c.Attributes.of(this.ss[0].attributes).attrs,{config:e}=t,i=s.__rest(t,["config"]),r={};return(e||"").split(",").forEach(t=>{const e=t.split("=");r[e[0]]=e[1]}),Object.assign({mode:"_",align:"_"},r,i)}toSvg(t,e){let i=t.map(t=>t.fit({x:0,y:0}));e&&(i=i.map(t=>t.fit({x:0,y:0},{width:i.get.box.width})));const s=i.svg(),n=r.Svg.of("svg",{xmlns:"http://www.w3.org/2000/svg",width:i.get.box.width.toString(),height:i.get.box.height.toString()});return n.appendChild(s),n}play(){const t=[],e=new n.Container("_init",{},new a.Portrait([],h.Box.zero));let i=!0;const{mode:s,align:c}=this.mode;return this.ss.reduce((e,n)=>{const a=o.Frame.of(n.blocks,n.attributes,n.childAttributes).setup(e),h=a.map(t=>t.fit({x:0,y:0})),u="center"===c?h.map(t=>t.fit({x:0,y:0},{width:h.get.box.width})):h,l=u.svg(),d=r.Svg.of("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${u.get.box.width} ${u.get.box.height}`,width:(u.get.box.width/2).toString(),height:(u.get.box.height/2).toString(),"font-size":"24"});return d.appendChild(l),t.push(d),"diff"===s||i?(i=!1,a):e},e),t}}},258:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(176),r=i(259);class n{constructor(t,e,i,s=[]){this.id=t,this.attrs=e,this.elem=i,this.overlays=s}get get(){return this.elem}updateAttributes(t){return this.attrs=Object.assign({},this.attrs,t.attrs),this.elem=this.elem.withBox(t.box),this}find(t){if(this.id===t)return this;{const e=[...this.elem.children.map(e=>e.find(t)),...this.overlays.map(e=>e.id===t?e:void 0)].filter(t=>t);return 1===e.length?e[0]:void 0}}map(t){return new n(this.id,this.attrs,t(this.elem),this.overlays)}append(t){return t instanceof n||t instanceof r.GridCell?new n(this.id,this.attrs,this.elem.append(t),this.overlays):new n(this.id,this.attrs,this.elem,[t,...this.overlays])}svg(){const t=this.elem.box,e=s.Svg.of("g",this.attrs),i=s.Svg.of("rect",Object.assign({id:`_gross_${this.id}`,fill:"none",stroke:"none",visibility:"hidden"},t));return e.appendChild(i),this.elem.children.map(t=>{const i=t.svg();e.appendChild(i)}),this.overlays.map(t=>t.applyTo(this).svg()).forEach(t=>e.appendChild(t)),e}}e.Container=n},259:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=i(260),n=i(336),o=i(337),a=i(338),h=i(339);class c{constructor(t,e,i){this.id=t,this.cell=e,this.attrs=i}static of(t,e,i){return new c(t,new h.Cell(e),i)}get get(){return this.cell}updateAttributes(t){return this.attrs=Object.assign({},this.attrs,t.attrs),this.cell=this.cell.withBox(t.box),this}find(t){return this.id===t?this:void 0}map(t){return new c(this.id,t(this.cell),this.attrs)}svg(){const t=this.attrs,{shape:e,label:i,t:h}=t,c=s.__rest(t,["shape","label","t"]),u=e||"box",l=new r.SvgText(i||this.id,h),d=Object.assign({"stroke-width":"2"},c);switch(u){case"box":return new n.Rect(this.id,this.cell.box,l,d).toSvgElement();case"cylinder":return new o.Cylinder(this.id,this.cell.box,l,d).toSvgElement();case"person":return new a.Person(this.id,this.cell.box,l,d).toSvgElement();default:throw new Error("not implemented: "+u)}}}e.GridCell=c},260:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159).__importDefault(i(335)),r=i(176);class n{constructor(t,e){this.label=t,this.content=e}static hash(t){const e=new s.default("SHA-1","TEXT");return e.update(t),e.getHash("HEX")}svg(t,e,i){const s=this.label,r=this.content;return this.text(t,e,s?r?s+"\\n"+r:s:r||"",i)}text(t,e,i,s){if(i){const o={fill:"black","stroke-width":"2"};for(const t in s)t.startsWith("text.")&&(o[t.slice("text.".length)]=s[t]);const a=r.Svg.of("text",Object.assign({id:"text_"+(s.id||n.hash(i)),x:t.toString(),y:e.toString()},o));return i.split("\\n").forEach(e=>{const i=r.Svg.of("tspan",Object.assign({x:t.toString(),dy:"1em"},o));i.appendChild(document.createTextNode(e)),a.appendChild(i)}),a}return r.Svg.of("text")}}e.SvgText=n},261:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159).__importDefault(i(180));class r{constructor(t,e){this.children=t,this.box=e}fit(t,e={}){const i=this.box.contentArea,n=this.box.calcContentArea(t,e),{x:o,y:a,width:h,height:c}=n;let u=a;const l=c?s.default.gap2((c-i.height)/(2*this.children.length),0):s.default.zero,d=h?{width:h}:{},_=c?{height:i.height/this.children.length}:{},g=[];for(const t of this.children){u+=l.top;const e=t.map(t=>t.fit({x:o,y:u},Object.assign({},d,_)));g.push(e),u+=e.get.box.grossArea.height,u+=l.bottom}const p=Math.max(...g.map(t=>t.get.box.grossArea.width)),m={x:o,y:a,width:p,height:u-a};return new r(g,this.box.inflate(m))}withBox(t){return new r(this.children,this.box.update(t))}append(t){return new r([...this.children,t],this.box)}}e.Portrait=r},262:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(168),r=i(344),n=i(192),o=i(202);class a{constructor(t,e,i,r=s.Attributes.empty){this.id=t,this.tailId=e,this.headId=i,this.attrs=r}static of(t,e,i,r=s.Attributes.empty){return new a(this.idOf(t,i),t,i,r)}static idOf(t,e){return`_edge_${t}_to_${e}`}static find(t){}setup(t){const e=t.container.find(this.tailId),i=t.container.find(this.headId);o.visible(e),o.visible(i);const s=t.container.find(this.id);if(s)return s.updateAttributes(this.attrs);{const t=n.Box.of(this.attrs.box);return new r.EdgeOverlay(this.id,this.tailId,this.headId,this.attrs.attrs,t)}}}e.Edge=a},263:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e,i,s){this.x1=t,this.y1=e,this.x2=i,this.y2=s}get length(){return Math.sqrt(Math.pow(this.dx,2)+Math.pow(this.dy,2))}get dx(){return this.x2-this.x1}get dy(){return this.y2-this.y1}rotate(t){const e=this.x1,i=this.y1,n=t*Math.PI/180;const o={real:Math.cos(n),imaginary:Math.sin(n)},a=r({real:this.dx,imaginary:this.dy},o);return new s(e,i,e+a.real,i+a.imaginary)}negate(){const t=this.x1,e=this.y1;return new s(t,e,t-this.dx,e-this.dy)}reverse(){return new s(this.x2,this.y2,this.x1,this.y1)}move(t,e){return new s(this.x1+t,this.y1+e,this.x2+t,this.y2+e)}normalize(){const t=this.length;return new s(0,0,this.dx/t,this.dy/t)}multiple(t){const e=this.x1,i=this.y1;return new s(e,i,e+this.dx*t,i+this.dy*t)}}function r(t,e){return{real:t.real*e.real-t.imaginary*e.imaginary,imaginary:t.real*e.imaginary+t.imaginary*e.real}}e.Vector2d=s,e.multiply=r},266:function(t,e,i){"use strict";i.r(e);var s=i(360),r=i(206);for(var n in r)"default"!==n&&function(t){i.d(e,t,function(){return r[t]})}(n);i(352);var o=i(0),a=Object(o.a)(r.default,s.a,s.b,!1,null,null,null);e.default=a.exports},267:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(268),r=i(257),n=i(351);e.toSvg=function(t,e){const i=s.parse(t);if(i instanceof r.Story){const t=i.play();return e?t.map(t=>n.convertSvg(t)):t}return i}},268:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(269),r=i(333),n=i(334),o=i(168),a=i(257),h=i(342),c=i(343),u=i(262),l=i(348),d=i(350);e.parse=function(t){const e=s.CharStreams.fromString(t),i=new _,o=new r.FurumaiLexer(e);o.removeErrorListeners(),o.addErrorListener(i);const a=new s.CommonTokenStream(o),h=new n.FurumaiParser(a);h.removeErrorListeners(),h.addErrorListener(i);const c=h.story();return i.errors.length>0?new SyntaxError(JSON.stringify(i.errors)):(new g).visit(c)};class _{constructor(){this.errors=[]}syntaxError(t,e,i,s,r,n){const o={message:r,range:{at:{column:s,row:i}}};this.errors.push(o)}}class g{static isBuildingBlock(t){return t instanceof l.Compound||t instanceof d.Node||t instanceof u.Edge||t instanceof h.HideBlock||t instanceof c.HideEdge}visitStory(t){if(t.EOF()){const e=t.moment().map(t=>this.visit(t));return new a.Story(e)}throw new SyntaxError("invalid input statement syntax")}visitMoment(t){return this.visit(t.stmt_list())}visitStmt_list(t){const e=t.stmt().map(t=>this.visit(t)),i=[],s=[],r=[];return e.forEach(t=>{if(g.isBuildingBlock(t))i.push(t);else if(t instanceof o.ElementAttribute)s.push(t);else{if(!(t instanceof o.Attribute))throw new Error("not implemented: "+JSON.stringify(t));r.push(t)}}),{blocks:i,attributes:r,childAttributes:s}}visitStmt(t){const e=t.node_stmt()||t.edge_stmt()||t.attr_stmt()||t.assignment()||t.zone()||t.group()||t.hide();if(e)return this.visit(e);throw new Error("not implemented")}visitAttr_stmt(t){const e=t.GROUP()||t.NODE()||t.EDGE()||t.ZONE(),i=t.attr_list(),s=i?this.visit(i):[];if(e)return new o.ElementAttribute(e.text,s);throw new Error("internal error: invalid state (parse)")}visitAttr_list(t){return t.assignment().map(t=>this.visit(t))}visitAssignment(t){const e=t.ID().map(t=>t.text);return new o.Attribute(e[0],e[1])}visitEdge_stmt(t){const e=t.ID().map(t=>t.text),i=t.attr_list();if(i){const t=this.visit(i);return u.Edge.of(e[0],"->",e[1],o.Attributes.of(t))}return u.Edge.of(e[0],"->",e[1])}visitNode_stmt(t){const e=t.attr_list();if(e){const i=this.visit(e);return new d.Node(t.ID().text,o.Attributes.of(i))}return new d.Node(t.ID().text)}visitGroup(t){const e=t.stmt_list();if(e){const i=this.visit(e),s=o.Attributes.of(i.attributes),r=o.toDict(i.childAttributes);return new l.Compound(t.ID().text,"group",i.blocks,s,r)}return new l.Compound(t.ID().text,"group")}visitZone(t){const e=t.stmt_list();if(e){const i=this.visit(e),s=o.Attributes.of(i.attributes),r=o.toDict(i.childAttributes);return new l.Compound(t.ID().text,"zone",i.blocks,s,r)}return new l.Compound(t.ID().text,"zone")}visitHide(t){const e=t.ID().map(t=>t.text);if(1===e.length)return new h.HideBlock(e[0]);if(2===e.length)return new c.HideEdge(e[0],e[1]);throw new Error("not implemented")}visit(t){return t.accept(this)}visitChildren(t){let e;const i=t.childCount;for(let s=0;s<i;s++){e=t.getChild(s).accept(this)}return e}visitErrorNode(t){}visitTerminal(t){}}},333:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=i(200),n=i(173),o=i(195),a=i(175),h=s.__importStar(i(165));class c extends n.Lexer{constructor(t){super(t),this._interp=new o.LexerATNSimulator(c._ATN,this)}get vocabulary(){return c.VOCABULARY}get grammarFileName(){return"Furumai.g4"}get ruleNames(){return c.ruleNames}get serializedATN(){return c._serializedATN}get channelNames(){return c.channelNames}get modeNames(){return c.modeNames}action(t,e,i){switch(e){case 15:this.ID_action(t,i)}}ID_action(t,e){switch(e){case 0:case 1:this.text=this.text.slice(1,-1)}}static get _ATN(){return c.__ATN||(c.__ATN=(new r.ATNDeserializer).deserialize(h.toCharArray(c._serializedATN))),c.__ATN}}c.T__0=1,c.T__1=2,c.T__2=3,c.T__3=4,c.T__4=5,c.T__5=6,c.T__6=7,c.T__7=8,c.T__8=9,c.NODE=10,c.EDGE=11,c.GROUP=12,c.ZONE=13,c.HIDE=14,c.DELETE=15,c.ID=16,c.SPACES=17,c.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"],c.modeNames=["DEFAULT_MODE"],c.ruleNames=["T__0","T__1","T__2","T__3","T__4","T__5","T__6","T__7","T__8","NODE","EDGE","GROUP","ZONE","HIDE","DELETE","ID","SPACES"],c._LITERAL_NAMES=[void 0,"'---'","';'","'['","','","']'","'='","'->'","'{'","'}'","'node'","'edge'","'group'","'zone'","'hide'","'delete'"],c._SYMBOLIC_NAMES=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"NODE","EDGE","GROUP","ZONE","HIDE","DELETE","ID","SPACES"],c.VOCABULARY=new a.VocabularyImpl(c._LITERAL_NAMES,c._SYMBOLIC_NAMES,[]),c._serializedATN='줝쪺֍꾺体؇쉁z\b\t\t\t\t\t\t\b\t\b\t\t\t\n\t\n\v\t\v\f\t\f\r\t\r\t\t\t\t\t\b\b\b\t\t\n\n\v\v\v\v\v\f\f\f\f\f\r\r\r\r\r\r^\n\fa\vg\n\fj\vp\n\fs\vu\n\t\v\r\b\t\n\v\f\r!#))$$//2;C\\aac|/02;C\\aac|\v\r""~\t\v\r!#%)+\t-\v/\r1368:?DJOT!t#v%&/&\'/\'(/()*=*+,],\b-...\n/0_0\f12?234/45@567}7899:;p;<q<=f=>g>?@g@AfABiBCgCDEiEFtFGqGHwHIrIJK|KLqLMpMNgNOPjPQkQRfRSgSTUfUVgVWnWXgXYvYZgZ [_)\\^\n]\\^a_]_``ba_bc)cu\bdh$eg\nfegjhfhiikjhkl$lu\bmq\tnp\tonpsqoqrrusqt[tdtmu"vw\twxxy\by$_hqt',e.FurumaiLexer=c},334:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=i(166),n=i(200),o=i(189),a=i(163),h=i(190),c=i(170),u=i(156),l=i(175),d=s.__importStar(i(165));class _ extends o.Parser{constructor(t){super(t),this._interp=new h.ParserATNSimulator(_._ATN,this)}get vocabulary(){return _.VOCABULARY}get grammarFileName(){return"Furumai.g4"}get ruleNames(){return _.ruleNames}get serializedATN(){return _._serializedATN}story(){let t,e=new g(this._ctx,this.state);this.enterRule(e,0,_.RULE_story);try{let i;for(this.enterOuterAlt(e,1),this.state=24,this.moment(),this.state=29,this._errHandler.sync(this),i=this.interpreter.adaptivePredict(this._input,0,this._ctx);2!==i&&i!==r.ATN.INVALID_ALT_NUMBER;)1===i&&(this.state=25,this.match(_.T__0),this.state=26,this.moment()),this.state=31,this._errHandler.sync(this),i=this.interpreter.adaptivePredict(this._input,0,this._ctx);this.state=33,this._errHandler.sync(this),(t=this._input.LA(1))===_.T__0&&(this.state=32,this.match(_.T__0)),this.state=35,this.match(_.EOF)}catch(t){if(!(t instanceof c.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}moment(){let t=new p(this._ctx,this.state);this.enterRule(t,2,_.RULE_moment);try{this.enterOuterAlt(t,1),this.state=37,this.stmt_list()}catch(e){if(!(e instanceof c.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}stmt_list(){let t,e=new m(this._ctx,this.state);this.enterRule(e,4,_.RULE_stmt_list);try{let i;for(this.enterOuterAlt(e,1),this.state=39,this.stmt(),this.state=44,this._errHandler.sync(this),i=this.interpreter.adaptivePredict(this._input,2,this._ctx);2!==i&&i!==r.ATN.INVALID_ALT_NUMBER;)1===i&&(this.state=40,this.match(_.T__1),this.state=41,this.stmt()),this.state=46,this._errHandler.sync(this),i=this.interpreter.adaptivePredict(this._input,2,this._ctx);this.state=48,this._errHandler.sync(this),(t=this._input.LA(1))===_.T__1&&(this.state=47,this.match(_.T__1))}catch(t){if(!(t instanceof c.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}stmt(){let t=new f(this._ctx,this.state);this.enterRule(t,6,_.RULE_stmt);try{switch(this.state=57,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,4,this._ctx)){case 1:this.enterOuterAlt(t,1),this.state=50,this.node_stmt();break;case 2:this.enterOuterAlt(t,2),this.state=51,this.edge_stmt();break;case 3:this.enterOuterAlt(t,3),this.state=52,this.attr_stmt();break;case 4:this.enterOuterAlt(t,4),this.state=53,this.assignment();break;case 5:this.enterOuterAlt(t,5),this.state=54,this.group();break;case 6:this.enterOuterAlt(t,6),this.state=55,this.zone();break;case 7:this.enterOuterAlt(t,7),this.state=56,this.hide()}}catch(e){if(!(e instanceof c.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}attr_stmt(){let t,e=new v(this._ctx,this.state);this.enterRule(e,8,_.RULE_attr_stmt);try{this.enterOuterAlt(e,1),this.state=59,0!=(-32&(t=this._input.LA(1)))||0==(1<<t&(1<<_.NODE|1<<_.EDGE|1<<_.GROUP|1<<_.ZONE))?this._errHandler.recoverInline(this):(this._input.LA(1)===u.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()),this.state=60,this.attr_list()}catch(t){if(!(t instanceof c.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}attr_list(){let t,e=new x(this._ctx,this.state);this.enterRule(e,10,_.RULE_attr_list);try{for(this.enterOuterAlt(e,1),this.state=62,this.match(_.T__2),this.state=63,this.assignment(),this.state=70,this._errHandler.sync(this),t=this._input.LA(1);0==(-32&t)&&0!=(1<<t&(1<<_.T__1|1<<_.T__3|1<<_.ID));)this.state=65,this._errHandler.sync(this),(t=this._input.LA(1))!==_.T__1&&t!==_.T__3||(this.state=64,(t=this._input.LA(1))!==_.T__1&&t!==_.T__3?this._errHandler.recoverInline(this):(this._input.LA(1)===u.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())),this.state=67,this.assignment(),this.state=72,this._errHandler.sync(this),t=this._input.LA(1);this.state=73,this.match(_.T__4)}catch(t){if(!(t instanceof c.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}assignment(){let t=new y(this._ctx,this.state);this.enterRule(t,12,_.RULE_assignment);try{this.enterOuterAlt(t,1),this.state=75,this.match(_.ID),this.state=76,this.match(_.T__5),this.state=77,this.match(_.ID)}catch(e){if(!(e instanceof c.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}edge_stmt(){let t,e=new b(this._ctx,this.state);this.enterRule(e,14,_.RULE_edge_stmt);try{this.enterOuterAlt(e,1),this.state=79,this.match(_.ID),this.state=80,this.match(_.T__6),this.state=81,this.match(_.ID),this.state=83,this._errHandler.sync(this),(t=this._input.LA(1))===_.T__2&&(this.state=82,this.attr_list())}catch(t){if(!(t instanceof c.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}node_stmt(){let t,e=new w(this._ctx,this.state);this.enterRule(e,16,_.RULE_node_stmt);try{this.enterOuterAlt(e,1),this.state=85,this.match(_.ID),this.state=87,this._errHandler.sync(this),(t=this._input.LA(1))===_.T__2&&(this.state=86,this.attr_list())}catch(t){if(!(t instanceof c.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}group(){let t=new E(this._ctx,this.state);this.enterRule(t,18,_.RULE_group);try{this.enterOuterAlt(t,1),this.state=89,this.match(_.GROUP),this.state=90,this.match(_.ID),this.state=91,this.match(_.T__7),this.state=92,this.stmt_list(),this.state=93,this.match(_.T__8)}catch(e){if(!(e instanceof c.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}zone(){let t=new A(this._ctx,this.state);this.enterRule(t,20,_.RULE_zone);try{this.enterOuterAlt(t,1),this.state=95,this.match(_.ZONE),this.state=96,this.match(_.ID),this.state=97,this.match(_.T__7),this.state=98,this.stmt_list(),this.state=99,this.match(_.T__8)}catch(e){if(!(e instanceof c.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}hide(){let t,e=new R(this._ctx,this.state);this.enterRule(e,22,_.RULE_hide);try{switch(this.enterOuterAlt(e,1),this.state=101,(t=this._input.LA(1))!==_.HIDE&&t!==_.DELETE?this._errHandler.recoverInline(this):(this._input.LA(1)===u.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()),this.state=106,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,9,this._ctx)){case 1:this.state=102,this.match(_.ID);break;case 2:this.state=103,this.match(_.ID),this.state=104,this.match(_.T__6),this.state=105,this.match(_.ID)}}catch(t){if(!(t instanceof c.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}static get _ATN(){return _.__ATN||(_.__ATN=(new n.ATNDeserializer).deserialize(d.toCharArray(_._serializedATN))),_.__ATN}}_.T__0=1,_.T__1=2,_.T__2=3,_.T__3=4,_.T__4=5,_.T__5=6,_.T__6=7,_.T__7=8,_.T__8=9,_.NODE=10,_.EDGE=11,_.GROUP=12,_.ZONE=13,_.HIDE=14,_.DELETE=15,_.ID=16,_.SPACES=17,_.RULE_story=0,_.RULE_moment=1,_.RULE_stmt_list=2,_.RULE_stmt=3,_.RULE_attr_stmt=4,_.RULE_attr_list=5,_.RULE_assignment=6,_.RULE_edge_stmt=7,_.RULE_node_stmt=8,_.RULE_group=9,_.RULE_zone=10,_.RULE_hide=11,_.ruleNames=["story","moment","stmt_list","stmt","attr_stmt","attr_list","assignment","edge_stmt","node_stmt","group","zone","hide"],_._LITERAL_NAMES=[void 0,"'---'","';'","'['","','","']'","'='","'->'","'{'","'}'","'node'","'edge'","'group'","'zone'","'hide'","'delete'"],_._SYMBOLIC_NAMES=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"NODE","EDGE","GROUP","ZONE","HIDE","DELETE","ID","SPACES"],_.VOCABULARY=new l.VocabularyImpl(_._LITERAL_NAMES,_._SYMBOLIC_NAMES,[]),_._serializedATN="줝쪺֍꾺体؇쉁o\t\t\t\t\t\t\b\t\b\t\t\t\n\t\n\v\t\v\f\t\f\r\t\r\n\f!\v$\n-\n\f0\v3\n<\nD\nG\n\fJ\v\b\b\b\b\t\t\t\t\tV\n\t\n\n\nZ\n\n\v\v\v\v\v\v\f\f\f\f\f\f\r\r\r\r\r\rm\n\r\r\b\n\f\fq')\b;\n=\f@MQW[ag!  #!\"$#\"#$$%%&&'(().\b*++-\b,*-0.,.//20.13212334<\n5<\t6<\n7<\b8<\v9<\f:<\r;4;5;6;7;8;9;:<\t=>\t>?\f?\v@AAH\bBD\tCBCDDEEG\bFCGJHFHIIKJHKLL\rMNNO\bOPPQRRS\tSUTV\fUTUVVWYXZ\fYXYZZ[\\\\]]^\n^__`\v`abbccd\ndeef\vfgl\thmijjk\tkmlhlim\f#.2;CHUYl",e.FurumaiParser=_;class g extends a.ParserRuleContext{moment(t){return void 0===t?this.getRuleContexts(p):this.getRuleContext(t,p)}EOF(){return this.getToken(_.EOF,0)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_story}enterRule(t){t.enterStory&&t.enterStory(this)}exitRule(t){t.exitStory&&t.exitStory(this)}accept(t){return t.visitStory?t.visitStory(this):t.visitChildren(this)}}e.StoryContext=g;class p extends a.ParserRuleContext{stmt_list(){return this.getRuleContext(0,m)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_moment}enterRule(t){t.enterMoment&&t.enterMoment(this)}exitRule(t){t.exitMoment&&t.exitMoment(this)}accept(t){return t.visitMoment?t.visitMoment(this):t.visitChildren(this)}}e.MomentContext=p;class m extends a.ParserRuleContext{stmt(t){return void 0===t?this.getRuleContexts(f):this.getRuleContext(t,f)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_stmt_list}enterRule(t){t.enterStmt_list&&t.enterStmt_list(this)}exitRule(t){t.exitStmt_list&&t.exitStmt_list(this)}accept(t){return t.visitStmt_list?t.visitStmt_list(this):t.visitChildren(this)}}e.Stmt_listContext=m;class f extends a.ParserRuleContext{node_stmt(){return this.tryGetRuleContext(0,w)}edge_stmt(){return this.tryGetRuleContext(0,b)}attr_stmt(){return this.tryGetRuleContext(0,v)}assignment(){return this.tryGetRuleContext(0,y)}group(){return this.tryGetRuleContext(0,E)}zone(){return this.tryGetRuleContext(0,A)}hide(){return this.tryGetRuleContext(0,R)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_stmt}enterRule(t){t.enterStmt&&t.enterStmt(this)}exitRule(t){t.exitStmt&&t.exitStmt(this)}accept(t){return t.visitStmt?t.visitStmt(this):t.visitChildren(this)}}e.StmtContext=f;class v extends a.ParserRuleContext{attr_list(){return this.getRuleContext(0,x)}GROUP(){return this.tryGetToken(_.GROUP,0)}NODE(){return this.tryGetToken(_.NODE,0)}EDGE(){return this.tryGetToken(_.EDGE,0)}ZONE(){return this.tryGetToken(_.ZONE,0)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_attr_stmt}enterRule(t){t.enterAttr_stmt&&t.enterAttr_stmt(this)}exitRule(t){t.exitAttr_stmt&&t.exitAttr_stmt(this)}accept(t){return t.visitAttr_stmt?t.visitAttr_stmt(this):t.visitChildren(this)}}e.Attr_stmtContext=v;class x extends a.ParserRuleContext{assignment(t){return void 0===t?this.getRuleContexts(y):this.getRuleContext(t,y)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_attr_list}enterRule(t){t.enterAttr_list&&t.enterAttr_list(this)}exitRule(t){t.exitAttr_list&&t.exitAttr_list(this)}accept(t){return t.visitAttr_list?t.visitAttr_list(this):t.visitChildren(this)}}e.Attr_listContext=x;class y extends a.ParserRuleContext{ID(t){return void 0===t?this.getTokens(_.ID):this.getToken(_.ID,t)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_assignment}enterRule(t){t.enterAssignment&&t.enterAssignment(this)}exitRule(t){t.exitAssignment&&t.exitAssignment(this)}accept(t){return t.visitAssignment?t.visitAssignment(this):t.visitChildren(this)}}e.AssignmentContext=y;class b extends a.ParserRuleContext{ID(t){return void 0===t?this.getTokens(_.ID):this.getToken(_.ID,t)}attr_list(){return this.tryGetRuleContext(0,x)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_edge_stmt}enterRule(t){t.enterEdge_stmt&&t.enterEdge_stmt(this)}exitRule(t){t.exitEdge_stmt&&t.exitEdge_stmt(this)}accept(t){return t.visitEdge_stmt?t.visitEdge_stmt(this):t.visitChildren(this)}}e.Edge_stmtContext=b;class w extends a.ParserRuleContext{ID(){return this.getToken(_.ID,0)}attr_list(){return this.tryGetRuleContext(0,x)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_node_stmt}enterRule(t){t.enterNode_stmt&&t.enterNode_stmt(this)}exitRule(t){t.exitNode_stmt&&t.exitNode_stmt(this)}accept(t){return t.visitNode_stmt?t.visitNode_stmt(this):t.visitChildren(this)}}e.Node_stmtContext=w;class E extends a.ParserRuleContext{GROUP(){return this.getToken(_.GROUP,0)}ID(){return this.getToken(_.ID,0)}stmt_list(){return this.getRuleContext(0,m)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_group}enterRule(t){t.enterGroup&&t.enterGroup(this)}exitRule(t){t.exitGroup&&t.exitGroup(this)}accept(t){return t.visitGroup?t.visitGroup(this):t.visitChildren(this)}}e.GroupContext=E;class A extends a.ParserRuleContext{ZONE(){return this.getToken(_.ZONE,0)}ID(){return this.getToken(_.ID,0)}stmt_list(){return this.getRuleContext(0,m)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_zone}enterRule(t){t.enterZone&&t.enterZone(this)}exitRule(t){t.exitZone&&t.exitZone(this)}accept(t){return t.visitZone?t.visitZone(this):t.visitChildren(this)}}e.ZoneContext=A;class R extends a.ParserRuleContext{HIDE(){return this.tryGetToken(_.HIDE,0)}DELETE(){return this.tryGetToken(_.DELETE,0)}ID(t){return void 0===t?this.getTokens(_.ID):this.getToken(_.ID,t)}constructor(t,e){super(t,e)}get ruleIndex(){return _.RULE_hide}enterRule(t){t.enterHide&&t.enterHide(this)}exitRule(t){t.exitHide&&t.exitHide(this)}accept(t){return t.visitHide?t.visitHide(this):t.visitChildren(this)}}e.HideContext=R},336:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(176),r=i(226);e.Rect=class{constructor(t,e,i,s){this.id=t,this.box=e,this.text=i,this.svgAttrs=s}toSvgElement(){const t=this.box,{x:e,y:i,width:n,height:o,margin:a,padding:h}=t,c=s.Svg.of("g",this.svgAttrs),u=s.Svg.of("rect",Object.assign({id:`_rect_${this.id}`,fill:"none",stroke:"black",x:e,y:i,width:n,height:o,margin:a,padding:h},this.svgAttrs)),l=this.text.svg(e+h.left,i+h.top,this.svgAttrs);return c.appendChild(u),c.appendChild(l),c.appendChild(r.marginRect(t)),c}}},337:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(176),r=i(226);e.Cylinder=class{constructor(t,e,i,s){this.id=t,this.box=e,this.text=i,this.svgAttrs=s}toSvgElement(){const t=this.box,{x:e,y:i,width:n,height:o}=t,a=s.Svg.of("g",this.svgAttrs),h=function(t,e,i,r,n){const o=8+1.2*i/20,a=t-i/2,h=t+i/2,c=e-r/2,u=c-o,l=c+o,d=e+r/2,_=d+o,g=s.Svg.of("path",Object.assign({fill:"none",stroke:"black"},n)),p=`M ${h},${c}\nC ${h},${l}\n  ${a},${l}\n  ${a},${c}\nM ${h},${c}\nC ${h},${u}\n  ${a},${u}\n  ${a},${c}\nM ${h},${c}\nL ${h},${d}\nC ${h},${_}\n  ${a},${_}\n  ${a},${d}\nL ${a},${c}`;return g.setAttribute("d",p),g}(t.cx,t.cy,n,o,Object.assign({id:`_rect_${this.id}`},this.svgAttrs)),c=this.text.svg(e+t.padding.left,i+t.padding.top,this.svgAttrs);return a.appendChild(h),a.appendChild(c),a.appendChild(r.marginRect(t)),a}}},338:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(176),r=i(226);e.Person=class{constructor(t,e,i,s){this.id=t,this.box=e,this.text=i,this.svgAttrs=s}toSvgElement(){const t=this.box,{x:e,y:i,width:n,height:o}=t,a=function(t,e,i,r,n){const o=t+i/2,a=e+r,h=r/5,c=o-h,u=o+h,l=e-h/3,d=e+h,_=e+2*h+h/3,g=t,p=t+i,m=e+2*h,f=e+3*h,v=4*h+e,x=s.Svg.of("path",Object.assign({fill:"none",stroke:"black"},n)),y=`M ${c},${d}\nC ${c},${_}\n${u},${_}\n${u},${d}\nM ${c},${d}\nC ${c},${l}\n${u},${l}\n${u},${d}\nM${o},${m}\nL${o},${v}\nM${g},${f}\nL${p},${f}\nM${o},${v}\nL${g},${a}\nM${o},${v}\nL${p},${a}`;return x.setAttribute("d",y),x}(e+n/4,i,n/2,o,this.svgAttrs),h=i-32,c=Object.assign({"text.text-anchor":"middle"},this.svgAttrs),u=this.text.svg(e+n/2,h,c),l=s.Svg.of("g",this.svgAttrs);return l.appendChild(a),l.appendChild(u),l.appendChild(r.marginRect(t)),l}}},339:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159).__importDefault(i(180));class r{constructor(t){this.box=t}static gap(t,e){const{width:i,height:r}=Object.assign({},t,e);return s.default.gap2(r-t.height,i-t.width)}fit(t,e){const i=r.gap(this.box.grossArea,e),s=t.x+i.left,n=t.y+i.right;return this.withBox(this.box.calcArea({x:s,y:n}))}withBox(t){return new r(this.box.update(t))}}e.Cell=r},340:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=i(168),n=i(341),o=s.__importDefault(i(180));class a{constructor(t,e,i,s,r){this.blocks=t,this.mode=e,this.align=i,this.attrs=s,this.childAttrs=r}static of(t,e,i){const n=r.Attributes.of(e),h=Object.assign({margin:o.default.zero,padding:o.default.zero},n.box),c=n.attrs,{config:u}=c,l=s.__rest(c,["config"]),d={};(u||"").split(",").forEach(t=>{const e=t.split("=");d[e[0]]=e[1]});const{mode:_,align:g}=Object.assign({mode:"_",align:"_"},d);return new a(t,_,g,new r.Attributes(h,l),r.toDict(i))}setup(t){const e=t.updateAttributes(this.attrs),i=n.Env.defaultEnv(e);return this.blocks.reduce((t,e)=>{const s=e.setup(i.newEnv(t,this.childAttrs));return s?t.append(s):t},e)}}e.Frame=a},341:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=i(168),n=s.__importDefault(i(180));class o{constructor(t,e,i){this.container=t,this.attrs=e,this.baseEnv=i}static defaultEnv(t){return new o(t,a)}newEnv(t,e){return new o(t,e,this)}lookupAttributes(t){const e=this.baseEnv?this.baseEnv.lookupAttributes(t):r.Attributes.empty;return this.attrs[t]?e.merge(this.attrs[t]):e}}e.Env=o;const a={group:r.Attributes.fromBox({margin:n.default.gap2(100,20),padding:n.default.gap2(20,16)}),zone:r.Attributes.fromBox({margin:n.default.gap2(20,150),padding:n.default.gap2(20,16)}),node:r.Attributes.fromBox({width:215,height:150,margin:n.default.gap2(24,20),padding:n.default.gap2(24,16)})}},342:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(202);e.HideBlock=class{constructor(t){this.id=t}setup(t){s.hide(t.container.find(this.id))}find(t){return t===this.id?this:void 0}}},343:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(262),r=i(202);e.HideEdge=class{constructor(t,e){this.tailId=t,this.headId=e}setup(t){r.hide(t.container.find(s.Edge.idOf(this.tailId,this.headId)))}find(t){}}},344:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159),r=i(168),n=i(345),o=i(260),a=i(346);class h{constructor(t,e,i,s,r){this.id=t,this.tailId=e,this.headId=i,this.attrs=s,this.box=r}static findBox(t,e){return t.find(e).get.box}updateAttributes(t){return this.attrs=Object.assign({},this.attrs,t.attrs),this.box=this.box.update(t.box),this}applyTo(t){const e=h.findBox(t,this.tailId),i=h.findBox(t,this.headId),o=this.attrs,{dx:a,dy:c}=o,u=s.__rest(o,["dx","dy"]),l=r.num(a)||0,d=r.num(c)||0,_=n.Arrow.singleton.fit(e,i,l,d),g=Object.assign({tx:`${l+(e.cx+i.cx)/2}`,ty:`${d+(e.cy+i.cy)/2}`},u);return new h(this.id,this.tailId,this.headId,g,_)}svg(){const t=this.attrs,{tx:e,ty:i,t:r,label:n}=t,h=s.__rest(t,["tx","ty","t","label"]),c=Object.assign({visibility:"visible"},h),u=new o.SvgText(n,r),l=Number(e),d=Number(i);return new a.SvgArrow(this.box,u,l,d,c).toSvgElement()}}e.EdgeOverlay=h},345:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(263),r=i(192);class n{fit(t,e,i,n){function o(t,e){const i=[];if(t.dx<0){const s=-(t.x1-e.cx+e.width/2)/t.dx;i.push(t.multiple(s))}else if(t.dx>0){const s=(e.cx-t.x1+e.width/2)/t.dx;i.push(t.multiple(s))}if(t.dy<0){const s=-(t.y1-e.cy+e.height/2)/t.dy;i.push(t.multiple(s))}else if(t.dy>0){const s=(e.cy-t.y1+e.height/2)/t.dy;i.push(t.multiple(s))}if(1===i.length)return i[0];if(2===i.length){const t=i[0],e=i[1];return t.length<e.length?t:e}throw new Error("not implemented: "+JSON.stringify(i)+", "+JSON.stringify(t))}const a=t.cx+i,h=t.cy+n,c=e.cx+i,u=e.cy+n,l=new s.Vector2d(a,h,c,u),d=o(l,t),_=o(l.reverse(),e),g=a+d.dx,p=h+d.dy,m=c+_.dx-g,f=u+_.dy-p;return r.Box.of({x:g,y:p,width:m,height:f})}}n.singleton=new n,e.Arrow=n},346:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(263),r=i(176),n=i(347);e.SvgArrow=class{constructor(t,e,i,s,r){this.box=t,this.text=e,this.tx=i,this.ty=s,this.svgAttrs=r}toSvgElement(){const{x:t,y:e,width:i,height:o}=this.box,a=t,h=e,c=t+i,u=e+o;function l(t,e){return new s.Vector2d(a,h,c,u).normalize().multiple(e).rotate(t).negate().move(c,u)}const d=n.defaults.arrow.head.degree,_=n.defaults.arrow.head.size,g=n.defaults.arrow.width,p=l(d,_),m=l(-d,_),f=r.Svg.of("path",Object.assign({stroke:"black","stroke-width":`${g}`},this.svgAttrs)),v=`M ${a} ${h}\nL ${c} ${u}\nM ${p.x2} ${p.y2}\nL ${c} ${u}\nM ${m.x2} ${m.y2}\nL ${c} ${u}`;f.setAttribute("d",v);const x={};Object.keys(this.svgAttrs).forEach(t=>{if(t.startsWith("text.")){const e=t.slice("text.".length,-1);x[e]=this.svgAttrs[t]}else"y"!==t&&(x[t]=this.svgAttrs[t])});const y=r.Svg.of("g",this.svgAttrs);let b=new s.Vector2d(a,h,c,u).normalize();b=(b=b.dy>0?b.rotate(-90):b.rotate(90)).multiple(24);const w=this.text.svg(this.tx+b.dx,this.ty+b.dy,x);return y.appendChild(f),y.appendChild(w),y}}},347:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaults={arrow:{width:2,head:{size:26,degree:27}}}},348:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(168),r=i(258),n=i(349),o=i(261),a=i(192);e.Compound=class{constructor(t,e,i=[],r=s.Attributes.empty,n){this.id=t,this.compoundType=e,this.blocks=i,this.attrs=r,this.childAttrs=n}setup(t){const e=t.lookupAttributes(this.compoundType).merge(this.attrs),i=e.attrs,s=e.box,h=new("zone"===this.compoundType?o.Portrait:n.Landscape)([],a.Box.of(s)),c=new r.Container(this.id,i,h);return this.blocks.reduce((e,i)=>{const s=i.setup(t.newEnv(e,this.childAttrs||{}));return s?e.append(s):e},c)}}},349:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159).__importDefault(i(180));class r{constructor(t,e){this.children=t,this.box=e}fit(t,e={}){const i=this.box.contentArea,n=this.box.calcContentArea(t,e),{x:o,y:a,width:h,height:c}=n;let u=o;const l=h?s.default.gap2(0,(h-i.width)/(2*this.children.length)):s.default.zero,d=h?{width:i.width/this.children.length}:{},_=c?{height:c}:{},g=[];for(const t of this.children){u+=l.left;const e=t.map(t=>t.fit({x:u,y:a},Object.assign({},d,_)));g.push(e),u+=e.get.box.grossArea.width,u+=l.right}const p=Math.max(...g.map(t=>t.get.box.grossArea.height)),m={x:o,y:a,width:u-o,height:p};return new r(g,this.box.inflate(m))}withBox(t){return new r(this.children,this.box.update(t))}append(t){return new r([...this.children,t],this.box)}}e.Landscape=r},350:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(168),r=i(259),n=i(192),o=i(202);e.Node=class{constructor(t,e=s.Attributes.empty){this.id=t,this.attrs=e}static find(t){}setup(t){const e=t.container.find(this.id);if(e)return o.visible(e),void e.updateAttributes(this.attrs);{const e=t.lookupAttributes("node").merge(this.attrs);return r.GridCell.of(this.id,n.Box.of(e.box),e.attrs)}}}},351:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(358),r=document;let n=new s.RoughSVG(document.createElementNS("http://www.w3.org/2000/svg","svg"));function o(t){const e={},i=t.attributes;for(let t=0;t<i.length;t++){const s=i.item(t);if(!s)throw new Error("null");e[s.name.replace(/[-_](.)/g,(t,e)=>e.toUpperCase())]=s.value,e[s.name]=s.value}return e}function a(t,e){return Object.keys(e).forEach(i=>t.setAttribute(i,e[i])),t}function h(t){const e=t.tagName,i=o(t),s=Object.assign({hachureGap:2,fillWeight:.6,roughness:2},i);switch(e){case"g":const c=a(r.createElementNS("http://www.w3.org/2000/svg","g"),o(t)),u=t.children;for(let t=0;t<u.length;t++){const e=u.item(t);if(!e)throw new Error("null");c.append(h(e))}return c;case"text":const l=a(r.createElementNS("http://www.w3.org/2000/svg","text"),o(t)),d=t.children;for(let t=0;t<d.length;t++){const e=d.item(t);if(!e)throw new Error("null");l.append(h(e))}return l;case"tspan":const _=a(r.createElementNS("http://www.w3.org/2000/svg","tspan"),o(t));return _.textContent=t.textContent,_;case"path":return n.path(i.d,i);case"line":return n.line(parseFloat(i.x1),parseFloat(i.y1),parseFloat(i.x1),parseFloat(i.y2),s);case"rect":return n.rectangle(parseFloat(i.x),parseFloat(i.y),parseFloat(i.width),parseFloat(i.height),s);case"ellipse":return n.ellipse(parseFloat(i.cx),parseFloat(i.cy),parseFloat(i.rx),parseFloat(i.ry),s);case"circle":return n.circle(parseFloat(i.cx),parseFloat(i.cy),parseFloat(i.r),s);case"polygon":default:throw new Error("not implemented")}}e.convertSvg=function(t){const e=t.getAttribute("width")||0,i=t.getAttribute("height")||0,r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("width",`${e}`),r.setAttribute("height",`${i}`),r.setAttribute("viewBox",`0 0 ${2*Number(e)} ${2*Number(i)}`),r.setAttribute("font-size","24"),n=new s.RoughSVG(r);const o=t.children;for(let t=0;t<o.length;t++){const e=o.item(t);if(!e)throw new Error("null");r.append(h(e))}return r}},352:function(t,e,i){"use strict";var s=i(227);i.n(s).a},353:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(159).__importDefault(i(354));e.DataEncoderDecoderV1=class{constructor(){this.formatVersion="v1"}decode(t){const e=s.default.decompressFromEncodedURIComponent(t);return JSON.parse(e)}encode(t){const e=JSON.stringify(t);return s.default.compressToEncodedURIComponent(e)}}},355:function(t,e,i){"use strict";var s=i(228);i.n(s).a},359:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("nav",{staticClass:"nav"},[i("div",{staticClass:"nav-right"},[i("a",{staticClass:"edit-button",attrs:{href:t.appUrl(t.url)}},[t._v("Edit")])])]),t._v(" "),1===t.version?i("FurumaiApp1",{attrs:{furumaiData:t.furumaiData,editorMode:!1,viewCode:"false"!==this.viewCode}}):-1===t.version?i("div",[t._v("version = -1")]):i("div",[t._v("version error: "+t._s(t.version))])],1)},r=[];i.d(e,"a",function(){return s}),i.d(e,"b",function(){return r})},360:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app1"},[i("div",{staticClass:"row"},[t.viewCode?i("div",{staticClass:"col"},[t.editorMode?i("div",{staticClass:"code-editor-wrap"},[i("label",[i("div",[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.furumaiData.code,expression:"furumaiData.code"}],ref:"editor",staticClass:"code-editor",attrs:{title:"Furumai Description"},domProps:{value:t.furumaiData.code},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey?t.furumai(e):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.altKey?t.furumai(e):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.metaKey?t.furumai(e):null}],input:function(e){e.target.composing||t.$set(t.furumaiData,"code",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"nav-right"},[i("label",{staticClass:"options"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.furumaiData.rough,expression:"furumaiData.rough"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.furumaiData.rough)?t._i(t.furumaiData.rough,null)>-1:t.furumaiData.rough},on:{change:[function(e){var i=t.furumaiData.rough,s=e.target,r=!!s.checked;if(Array.isArray(i)){var n=t._i(i,null);s.checked?n<0&&t.$set(t.furumaiData,"rough",i.concat([null])):n>-1&&t.$set(t.furumaiData,"rough",i.slice(0,n).concat(i.slice(n+1)))}else t.$set(t.furumaiData,"rough",r)},t.furumai]}}),t._v("Rough.js\n            ")]),t._v(" "),i("label",{staticClass:"options"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.furumaiData.displayFirstSvg,expression:"furumaiData.displayFirstSvg"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.furumaiData.displayFirstSvg)?t._i(t.furumaiData.displayFirstSvg,null)>-1:t.furumaiData.displayFirstSvg},on:{change:[function(e){var i=t.furumaiData.displayFirstSvg,s=e.target,r=!!s.checked;if(Array.isArray(i)){var n=t._i(i,null);s.checked?n<0&&t.$set(t.furumaiData,"displayFirstSvg",i.concat([null])):n>-1&&t.$set(t.furumaiData,"displayFirstSvg",i.slice(0,n).concat(i.slice(n+1)))}else t.$set(t.furumaiData,"displayFirstSvg",r)},t.furumai]}}),t._v("Display 1st SVG\n            ")]),t._v(" "),i("button",{staticClass:"button primary furumai-button",on:{click:t.furumai}},[t._v("View (Ctrl + Enter)")])])])]):i("div",{staticClass:"code-viewer"},[i("pre",{staticClass:"language-none"},[t._v(t._s(t.pre(t.furumaiData.code)))])])]):t._e(),t._v(" "),i("div",{staticClass:"col-6"},[t.errors.length>0?i("div",{staticClass:"text-error"},[i("pre",[t._v(t._s(t.errors))])]):t._e(),t._v(" "),i("div",{ref:"moments"}),t._v(" "),i("div",{staticClass:"nav-right moments-footer"},[t.editorMode?i("button",{staticClass:"button primary",on:{click:t.download}},[t._v("Download SVG(s)")]):t._e()])])])])},r=[];i.d(e,"a",function(){return s}),i.d(e,"b",function(){return r})},362:function(t,e,i){"use strict";i.r(e);var s=i(359),r=i(204);for(var n in r)"default"!==n&&function(t){i.d(e,t,function(){return r[t]})}(n);i(355);var o=i(0),a=Object(o.a)(r.default,s.a,s.b,!1,null,null,null);e.default=a.exports}}]);